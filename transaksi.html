<!-- transaksi.html --><!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Transaksi - Asdar Store Digital</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body { background: #f0f4ff; color: #333; padding: 16px; }
    header { text-align: center; padding: 30px 16px; background: #007BFF; color: white; border-radius: 16px; margin-bottom: 24px; }
    header h1 { font-size: 2em; margin-bottom: 6px; }
    .card { background: white; border-radius: 16px; padding: 20px; box-shadow: 0 8px 20px rgba(0,0,0,0.08); margin-bottom: 24px; }
    .btn { background: #007BFF; color: white; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; margin-top: 14px; }
    input, textarea { width: 100%; padding: 12px; margin-top: 10px; border: 1px solid #ccc; border-radius: 10px; font-size: 1em; }
    img { max-width: 100%; border-radius: 12px; margin-top: 10px; }
    footer { text-align: center; margin-top: 40px; color: #777; font-size: 0.9em; }
  </style>
</head>
<body>
  <header>
    <h1>Transaksi Pembelian</h1>
    <p>Upload bukti pembayaran & isi data Anda</p>
  </header>  <section class="card">
    <h2>Data Pembeli</h2>
    <input type="text" id="nama" placeholder="Nama Anda" />
    <input type="text" id="nomorHP" placeholder="Nomor WhatsApp" />
  </section>  <section class="card">
    <h2>Bukti Pembayaran</h2>
    <input type="file" id="buktiBayar" accept="image/*" onchange="previewImage(event)" />
    <img id="previewImage" />
    <button class="btn" onclick="kirimTransaksi()">Kirim Bukti</button>
  </section>  <footer>
    &copy; 2025 Asdar Store Digital
  </footer>  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
      authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
      databaseURL: "https://asdarstoredigitalll-d89c4-default-rtdb.firebaseio.com",
      projectId: "asdarstoredigitalll-d89c4",
      storageBucket: "asdarstoredigitalll-d89c4.appspot.com",
      messagingSenderId: "220670500351",
      appId: "1:220670500351:web:5737ae5958a6f5a67d5bca"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const dataProduk = JSON.parse(localStorage.getItem("produkDipilih"));

    function previewImage(event) {
      const image = document.getElementById("previewImage");
      image.src = URL.createObjectURL(event.target.files[0]);
    }

    function kirimTransaksi() {
      const nama = document.getElementById("nama").value;
      const nomorHP = document.getElementById("nomorHP").value;
      const file = document.getElementById("buktiBayar").files[0];
      if (!nama || !nomorHP || !file) return alert("Isi semua data dan upload bukti bayar.");

      const reader = new FileReader();
      reader.onloadend = function () {
        const imageUrl = reader.result;
        const transaksi = {
          nama,
          idpel: nomorHP,
          produkNama: dataProduk.nama,
          harga: parseInt(dataProduk.harga),
          buktiBayarUrl: imageUrl,
          status: "Pending"
        };
        const ref = db.ref("transaksi").push();
        ref.set(transaksi).then(() => {
          alert("Transaksi berhasil dikirim!");
          localStorage.removeItem("produkDipilih");
          window.location.href = "status.html?hp=" + encodeURIComponent(nomorHP);
        });
      };
      reader.readAsDataURL(file);
    }
  </script></body>
</html>
