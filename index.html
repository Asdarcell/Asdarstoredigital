<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Asdar Store Digital</title>
  <style>
    /* (CSS sama seperti sebelumnya untuk layout, panel, form, marquee) */
    body { font-family: 'Segoe UI', sans-serif; background: #e9f1f7; margin: 0; padding: 20px; }
    header { background: #1976d2; color: white; padding: 20px; text-align: center; position: relative; font-size:1.4rem; margin-bottom:20px; border-radius:10px; }
    .marquee { position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.15); color: white; font-size: 0.9rem; padding: 5px 0; white-space: nowrap; overflow: hidden; border-radius: 0 0 10px 10px; }
    .marquee span { display: inline-block; padding-left: 100%; animation: marquee 20s linear infinite; }
    @keyframes marquee { 0% { transform: translateX(0%); } 100% { transform: translateX(-100%); } }
    .menu { display: flex; justify-content: center; gap: 12px; margin-bottom: 20px; }
    .menu button { background: #3498db; border: none; padding: 12px 20px; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; }
    .panel { display: none; background: white; padding: 20px; border-radius: 10px; }
    .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
    input, textarea { width: 100%; padding: 10px; margin-bottom: 12px; border:1px solid #ccc; border-radius: 6px; font-size:1rem; }
    button.submit-btn { background: #1976d2; color: white; border: none; padding: 12px 18px; border-radius:6px; cursor: pointer; }
    #notif { font-weight:600; margin-top:10px; }
    #notif.success { color: green; }
    #notif.error { color: red; }
  </style>
</head>
<body>

<header>
  Asdar Store Digital
  <div class="marquee"><span id="liveText">Selamat datang! Silakan kirim testimoni 😊</span></div>
</header>

<div class="menu">
  <button onclick="togglePanel('produk')">📦 Produk</button>
  <button onclick="togglePanel('stok')">📋 Stok</button>
</div>

<div id="produk" class="panel">
  <!-- (Isi produk seperti sebelumnya) -->
  <p>Contoh produk di sini...</p>
</div>

<div id="stok" class="panel">
  <ul><li>XL Unlimited: ready</li><li>K-Vision: ready</li></ul>
</div>

<div class="container">
  <h3>Kirim Testimoni Anda</h3>
  <form id="testiForm">
    <input type="text" id="nama" placeholder="Nama Anda" required />
    <textarea id="pesan" rows="3" placeholder="Komentar Anda" required></textarea>
    <button class="submit-btn" type="submit">Kirim</button>
    <div id="notif"></div>
  </form>
</div>

<!-- Firebase compat SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
    authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
    databaseURL: "https://asdarstoredigitalll-d89c4-default-rtdb.firebaseio.com",
    projectId: "asdarstoredigitalll-d89c4",
    storageBucket: "asdarstoredigitalll-d89c4.firebasestorage.app",
    messagingSenderId: "220670500351",
    appId: "1:220670500351:web:5737ae5958a6f5a67d5bca",
    measurementId: "G-CMRW37J19G"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const blacklist = ["penipuan","bohong","jelek","gak jelas","buruk","tidak terpercaya"];
  const form = document.getElementById("testiForm"), notif = document.getElementById("notif");

  form.addEventListener("submit", e => {
    e.preventDefault();
    const nama = form.nama.value.trim(), pesan = form.pesan.value.trim();
    if (!nama || !pesan) return;
    if (blacklist.some(w => pesan.toLowerCase().includes(w))) {
      notif.textContent = "Pesan mengandung kata terlarang.";
      notif.className = "error";
      return;
    }
    db.ref("testimoni").push({ nama, pesan, waktu: Date.now() }, err => {
      if (err) { notif.textContent = "Gagal kirim."; notif.className = "error";}
      else { notif.textContent = "Dikirim!"; notif.className = "success"; form.reset(); }
    });
  });

  document.getElementById("liveText").textContent = "Memuat testimoni...";

  function loadLive() {
    db.ref("testimoni").limitToLast(10).on("value", snap => {
      const arr = [];
      snap.forEach(c => arr.push(`${c.val().nama}: "${c.val().pesan}"`));
      const text = arr.reverse().join(" ❖ ");
      document.getElementById("liveText").textContent = text || "Belum ada testimoni.";
    });
  }
  loadLive();

  function togglePanel(id) {
    document.querySelectorAll('.panel').forEach(p => p.style.display = 'none');
    const el = document.getElementById(id);
    el.style.display = el.style.display === 'block' ? 'none' : 'block';
  }
</script>
</body>
</html>
