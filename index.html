<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Asdar Store Digital</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #e9f1f7; margin: 0; padding: 20px; }
    header {
      background: #1976d2; color: white; padding: 20px; text-align: center;
      position: relative; font-size: 1.4rem; margin-bottom: 20px; border-radius: 10px;
    }
    .marquee {
      position: absolute; bottom: 0; width: 100%; background: rgba(0,0,0,0.15);
      color: white; font-size: 0.9rem; padding: 5px 0; white-space: nowrap; overflow: hidden;
      border-radius: 0 0 10px 10px;
    }
    .marquee span {
      display: inline-block; padding-left: 100%; animation: marquee 20s linear infinite;
    }
    @keyframes marquee { 0% { transform: translateX(0%); } 100% { transform: translateX(-100%); } }
    .menu { display: flex; justify-content: center; gap: 12px; margin-bottom: 20px; }
    .menu button { background: #3498db; border: none; padding: 12px 20px; border-radius: 10px; color: white; font-weight: bold; cursor: pointer; }
    .panel { display: none; background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
    .product { margin-bottom: 15px; }
    .product h4 { margin: 0; cursor: pointer; color: #2c3e50; }
    .product-list { margin-left: 15px; margin-top: 10px; display: none; }
    .product-list div { margin-bottom: 8px; }
    .btn-wa { background: #25d366; color: white; text-decoration: none; padding: 8px 14px; border-radius: 6px; display: inline-block; margin-top: 5px; font-size: 0.9rem; }
    .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
    input, textarea { width: 100%; padding: 10px; margin-bottom: 12px; border:1px solid #ccc; border-radius: 6px; font-size:1rem; }
    button.submit-btn { background: #1976d2; color: white; border: none; padding: 12px 18px; border-radius:6px; cursor: pointer; font-size:1rem; }
    button.submit-btn:hover { background: #145ca8; }
    #notif { font-weight:600; margin-top:10px; }
    #notif.success { color: green; }
    #notif.error { color: red; }
    ul { padding-left: 20px; }
  </style>
</head>
<body>

<header>
  Asdar Store Digital
  <div class="marquee"><span id="liveText">Selamat datang—belum ada testimoni.</span></div>
</header>

<div class="menu">
  <button onclick="togglePanel('produk')">📦 Produk</button>
  <button onclick="togglePanel('stok')">📋 Stok</button>
</div>

<div id="produk" class="panel">
  <div class="product">
    <h4 onclick="toggleList(this)">XL Unlimited ▸</h4>
    <div class="product-list">
      <div>Rp 75.000 – semua aplikasi (kecuali TikTok)</div>
      <a class="btn-wa" href="https://wa.me/6281803004607?text=Pesan%20XL%20Unlimited" target="_blank">Pesan Sekarang</a>
    </div>
  </div>
  <div class="product">
    <h4 onclick="toggleList(this)">XL + TikTok ▸</h4>
    <div class="product-list">
      <div>Rp 80.000 – semua aplikasi termasuk TikTok</div>
      <a class="btn-wa" href="https://wa.me/6281803004607?text=Pesan%20XL%20Full%20TikTok" target="_blank">Pesan Sekarang</a>
    </div>
  </div>
  <div class="product">
    <h4 onclick="toggleList(this)">Voucher K‑Vision ▸</h4>
    <div class="product-list">
      <div>Mulai Rp 25.000 – Paket Cling, Film, Liga 1</div>
      <a class="btn-wa" href="https://wa.me/6281803004607?text=Pesan%20K-Vision" target="_blank">Pesan Sekarang</a>
    </div>
  </div>
  <div class="product">
    <h4 onclick="toggleList(this)">Topup Pulsa ▸</h4>
    <div class="product-list">
      <div>All operator – nominal bebas</div>
      <a class="btn-wa" href="https://wa.me/6281803004607?text=Topup%20Pulsa" target="_blank">Pesan Sekarang</a>
    </div>
  </div>
  <div class="product">
    <h4 onclick="toggleList(this)">Token Listrik ▸</h4>
    <div class="product-list">
      <div>Nominal mulai Rp 20.000</div>
      <a class="btn-wa" href="https://wa.me/6281803004607?text=Pesan%20Token%20Listrik" target="_blank">Pesan Sekarang</a>
    </div>
  </div>
</div>

<div id="stok" class="panel">
  <p>✅ Stok Hari Ini:</p>
  <ul>
    <li>XL Unlimited: 10 ready</li>
    <li>K‑Vision: 25 voucher</li>
    <li>Token Listrik: 24/7 siap</li>
  </ul>
</div>

<div class="container">
  <h3>Kirim Testimoni Anda</h3>
  <form id="testiForm">
    <input type="text" id="nama" name="nama" placeholder="Nama Anda" required />
    <textarea id="pesan" name="pesan" rows="3" placeholder="Komentar Anda" required></textarea>
    <button class="submit-btn" type="submit">Kirim</button>
    <div id="notif"></div>
  </form>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
  const cfg = {
    apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
    authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
    databaseURL: "https://asdarstoredigitalll-d89c4-default-rtdb.firebaseio.com",
    projectId: "asdarstoredigitalll-d89c4",
    storageBucket: "asdarstoredigitalll-d89c4.firebasestorage.app",
    messagingSenderId: "220670500351",
    appId: "1:220670500351:web:5737ae5958a6f5a67d5bca",
    measurementId: "G-CMRW37J19G"
  };
  firebase.initializeApp(cfg);
  const db = firebase.database();
  const blacklist = ["penipuan","bohong","jelek","gak jelas","buruk","tidak terpercaya"];
  const form = document.getElementById("testiForm"), notif = document.getElementById("notif");

  form.addEventListener("submit", e => {
    e.preventDefault();
    const nama = form.nama.value.trim();
    const pesan = form.pesan.value.trim();
    if (!nama || !pesan) return;
    if (blacklist.some(w => pesan.toLowerCase().includes(w))) {
      notif.textContent = "Pesan mengandung kata terlarang.";
      notif.className = "error";
      return;
    }
    db.ref("testimoni").push({ nama, pesan, waktu: Date.now() }, err => {
      if (err) { notif.textContent = "Gagal kirim."; notif.className = "error"; }
      else { notif.textContent = "Dikirim!"; notif.className = "success"; form.reset(); }
    });
  });

  function loadLive() {
    db.ref("testimoni").limitToLast(10).on("value", snap => {
      const arr = [];
      snap.forEach(c => arr.push(`${c.val().nama}: "${c.val().pesan}"`));
      const text = arr.reverse().join(" ❖ ");
      document.getElementById("liveText").textContent = text || "Belum ada testimoni.";
    });
  }
  loadLive();

  function togglePanel(id) {
    document.querySelectorAll('.panel').forEach(p => p.style.display = 'none');
    const el = document.getElementById(id);
    el.style.display = el.style.display === 'block' ? 'none' : 'block';
  }

  function toggleList(h) {
    const L = h.nextElementSibling;
    const showing = L.style.display === "block";
    document.querySelectorAll('.product-list').forEach(x => x.style.display = "none");
    document.querySelectorAll('.product h4').forEach(x => x.textContent = x.textContent.replace('▾','▸'));
    if (!showing) {
      L.style.display = "block";
      h.textContent = h.textContent.replace('▸','▾');
    }
  }
</script>

</body>
</html>
