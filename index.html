
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Asdar Store Digital</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }
    body { font-family: 'Poppins', sans-serif; background: #f1f7ff; color: #333; padding: 20px; }
    header { background: #007BFF; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
    nav button { background: transparent; border: none; color: white; font-size: 16px; margin: 0 10px; cursor: pointer; transition: all 0.3s ease; }
    nav button:hover { transform: scale(1.1); color: #ffeb3b; }
    .page { display: none; }
    .active { display: block; }
    .card, .produk-card, .testimoni-card { background: white; padding: 20px; margin-bottom: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
    label, select, input, button, textarea { width: 100%; font-size: 16px; margin: 10px 0; padding: 10px; border-radius: 8px; border: 1px solid #ccc; }
    button { background: #28a745; color: white; border: none; cursor: pointer; font-weight: bold; }
    button:hover { background: #218838; }
    #kirimWA { background: green; display: none; }
    .marquee { background: #e3f2fd; padding: 10px; white-space: nowrap; overflow: hidden; }
    .marquee span { display: inline-block; padding-right: 100%; animation: scroll 15s linear infinite; }
    .marquee:hover span { animation-play-state: paused; }
    @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-100%); } }
    footer { text-align: center; font-size: 14px; color: #666; background: #e3f2fd; margin-top: 40px; padding: 15px; }
  </style>
</head>
<body>
<header>
  <strong>Asdar Store Digital</strong>
  <nav>
    <button onclick="showPage('home')">üè† Home</button>
    <button onclick="showPage('produk')">üõí Produk</button>
    <button onclick="showPage('testimoni')">üí¨ Testimoni</button>
    <button onclick="showPage('upload')">üì§ Upload</button>
  </nav>
</header>

<div class="marquee"><span id="marqueeText">Selamat datang di Asdar Store Digital - Voucher TV, Paket Data, dan Token PLN!</span></div>

<div id="home" class="page active">
  <h2>‚ú® Selamat Datang!</h2>
  <p>Tempat terbaik untuk beli voucher TV digital, paket data XL unlimited, dan token listrik. Harga bersaing dan proses instan!</p>
</div>

<div id="produk" class="page">
  <h2>üõçÔ∏è Produk Tersedia</h2>
  <select onchange="filterKategori(this.value)">
    <option value="semua">Semua</option>
    <option value="K-Vision">K-Vision</option>
    <option value="Nex Parabola">Nex Parabola</option>
    <option value="MNC Vision">MNC Vision</option>
    <option value="XL">Paket XL</option>
    <option value="PLN">Token PLN</option>
  </select>
  <div id="produkList">
    <div class="produk-card" data-kategori="K-Vision">K-Vision - Paket Cling 1 Bulan - 39.000</div>
    <div class="produk-card" data-kategori="Nex Parabola">Nex Parabola - Basic 30 Hari - 45.000</div>
    <div class="produk-card" data-kategori="MNC Vision">MNC Vision - Jawara 1 Bulan - 39.000</div>
    <div class="produk-card" data-kategori="XL">XL - Unlimited TikTok 80rb</div>
    <div class="produk-card" data-kategori="XL">XL - Unlimited No TikTok 75rb</div>
    <div class="produk-card" data-kategori="PLN">Token PLN - 50.000</div>
  </div>
</div>

<div id="upload" class="page">
  <h2>üßæ Upload Bukti Bayar</h2>
  <select id="varianProduk">
    <option value="">-- Pilih Varian --</option>
  </select>
  <input type="file" id="buktiInput" accept="image/*">
  <button onclick="uploadToImgbb()">‚úÖ Upload Bukti Bayar</button>
  <button id="kirimWA">üì≤ Kirim ke WhatsApp</button>
</div>

<div id="testimoni" class="page">
  <h2>üí¨ Testimoni Pelanggan</h2>
  <input id="nama" placeholder="Nama Anda" required />
  <textarea id="pesan" placeholder="Tulis testimoni Anda..." required></textarea>
  <button onclick="kirimTestimoni(event)">Kirim Testimoni</button>
  <div id="listTestimoni"></div>
</div>

<footer>&copy; 2025 Asdar Store Digital - Powered by Firebase & WhatsApp API</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
    authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
    projectId: "asdarstoredigitalll-d89c4",
    storageBucket: "asdarstoredigitalll.appspot.com",
    messagingSenderId: "220670500351",
    appId: "1:220670500351:web:5737ae5958a6f5a67d5bca"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);
  const testiRef = ref(db, 'testimoni');

  onValue(testiRef, snapshot => {
    const data = snapshot.val();
    const list = document.getElementById('listTestimoni');
    const marquee = document.getElementById('marqueeText');
    list.innerHTML = '';
    let gabungan = "Selamat datang di Asdar Store Digital ‚Äî ";
    for (let id in data) {
      const { nama, pesan } = data[id];
      if (isNegative(pesan)) continue;
      const card = document.createElement('div');
      card.className = 'testimoni-card';
      card.innerHTML = `<strong>${nama}:</strong><p>${pesan}</p>`;
      list.appendChild(card);
      gabungan += `${nama}: ${pesan} ‚ö° `;
    }
    marquee.textContent = gabungan;
  });

  const API_KEY = "f71ccc1a662c9f8656766990018d3a33";
  let buktiURL = "";

  window.uploadToImgbb = async function () {
    const file = document.getElementById('buktiInput').files[0];
    const varian = document.getElementById('varianProduk').value;
    if (!file) return alert("Pilih gambar bukti pembayaran dulu.");

    const formData = new FormData();
    formData.append("image", file);

    try {
      const response = await fetch(`https://api.imgbb.com/1/upload?key=${API_KEY}`, {
        method: "POST", body: formData
      });
      const result = await response.json();
      buktiURL = result.data.url;
      alert("Upload berhasil!");
      document.getElementById("kirimWA").style.display = "block";
      document.getElementById("kirimWA").onclick = () => {
        const waNomor = "6281803004607";
        const pesan = `Halo Admin, saya sudah transfer.

Varian: ${varian}
Bukti: ${buktiURL}`;
        window.open(`https://wa.me/${waNomor}?text=${encodeURIComponent(pesan)}`, "_blank");
      };
    } catch (error) {
      alert("Upload gagal, coba lagi."); console.error(error);
    }
  };

  window.kirimTestimoni = function (event) {
    event.preventDefault();
    const nama = document.getElementById('nama').value.trim();
    const pesan = document.getElementById('pesan').value.trim();
    if (!nama || !pesan) return alert("Isi nama dan testimoni dulu!");
    if (isNegative(pesan)) return alert("Maaf, testimoni Anda tidak diterima.");
    push(testiRef, { nama, pesan });
    alert("Testimoni berhasil dikirim!");
    document.getElementById('nama').value = '';
    document.getElementById('pesan').value = '';
  };

  window.filterKategori = function (kategori) {
    document.querySelectorAll('.produk-card').forEach(p => {
      p.style.display = (kategori === "semua" || p.dataset.kategori === kategori) ? "block" : "none";
    });
  };

  window.showPage = function (id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  };

  function isNegative(text) {
    const blacklist = ["jelek", "buruk", "tidak puas", "mengecewakan", "bohong", "tipu", "gak", "ga", "tidak", "salah", "nggak", "parah"];
    return blacklist.some(kata => text.toLowerCase().includes(kata));
  }

  document.querySelectorAll('.produk-card').forEach(card => {
    card.style.cursor = "pointer";
    card.onclick = () => {
      const namaProduk = card.textContent.trim();
      const select = document.getElementById('varianProduk');
      let sudahAda = false;
      for (let i = 0; i < select.options.length; i++) {
        if (select.options[i].value === namaProduk) {
          sudahAda = true;
          select.selectedIndex = i;
          break;
        }
      }
      if (!sudahAda) {
        const opsi = document.createElement("option");
        opsi.value = namaProduk;
        opsi.textContent = namaProduk;
        select.appendChild(opsi);
        select.value = namaProduk;
      }
      showPage('upload');
    };
  });
</script>
</body>
</html>
