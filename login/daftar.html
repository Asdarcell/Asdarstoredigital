<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login / Daftar - Asdar Store Digital</title>
  <link rel="icon" href="favicon.png" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <style>
    /* === KOLEKSI TEMA LENGKAP (SESUAI DENGAN INDEX.HTML) === */
    :root { /* Tema Default: Light */
      --bg: #f9f9f9; --text: #2c3e50; --primary: #3498db;
      --card: #ffffff; --border: #ddd; --shadow: rgba(0, 0, 0, 0.05);
      --success: #28a745; --danger: #e74c3c;
      --muted-text: #6c757d;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="dark"] {
      --bg: #1a1a2e; --text: #e0e0e0; --primary: #1abc9c;
      --card: #2c2c40; --border: #444; --shadow: rgba(0, 0, 0, 0.15);
      --muted-text: #8a93a2;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="forest"] {
      --bg: #2A3F28; --text: #E8E8E8; --primary: #6A8B41;
      --card: #3E5F3B; --border: #557553; --shadow: rgba(0, 0, 0, 0.2);
      --muted-text: #b0c4b1; --success: #98FB98;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="ocean"] {
      --bg: #0F2027; --text: #ECF0F1; --primary: #4364F7;
      --card: #203A43; --border: #2C5364; --shadow: rgba(0, 0, 0, 0.2);
      --muted-text: #bdc3c7; --success: #2ecc71;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="sunset"] {
      --bg: linear-gradient(135deg, #622774, #C53364); --text: #ffffff; --primary: #ff7e5f;
      --card: rgba(255, 255, 255, 0.1); --border: rgba(255, 255, 255, 0.2);
      --shadow: rgba(0, 0, 0, 0.25); --muted-text: #f5f6fa;
      --success: #feb47b;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="dracula"] {
      --bg: #282a36; --text: #f8f8f2; --primary: #bd93f9;
      --card: #44475a; --border: #6272a4; --shadow: rgba(0, 0, 0, 0.2);
      --muted-text: #bdc3c7; --success: #50fa7b; --danger: #ff5555;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="sakura"] {
      --bg: #fff0f5; --text: #583c47; --primary: #ff69b4;
      --card: #ffffff; --border: #f8d7e7; --shadow: rgba(0, 0, 0, 0.05);
      --muted-text: #8c737c; --success: #90ee90; --danger: #ff7f7f;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="mint"] {
      --bg: #f0fff0; --text: #003333; --primary: #00aaa0;
      --card: #ffffff; --border: #cce8e8; --shadow: rgba(0, 0, 0, 0.06);
      --muted-text: #5f9ea0; --success: #3cb371; --danger: #f08080;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="royal"] {
      --bg: #f0f2f5; --text: #1d2d3d; --primary: #d4af37;
      --card: #ffffff; --border: #e8e8e8; --shadow: rgba(0, 0, 0, 0.07);
      --muted-text: #5a6b7c; --success: #28a745; --danger: #e74c3c;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="espresso"] {
      --bg: #362222; --text: #e8d8c9; --primary: #a67b5b;
      --card: #4a3737; --border: #6b5555; --shadow: rgba(0, 0, 0, 0.15);
      --muted-text: #bcaaa4; --success: #81c784; --danger: #ef9a9a;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="lavender"] {
      --bg: #f3e5f5; --text: #4a148c; --primary: #9c27b0;
      --card: #ffffff; --border: #e1bee7; --shadow: rgba(0, 0, 0, 0.06);
      --muted-text: #8e24aa; --success: #66bb6a; --danger: #ef5350;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="synthwave"] {
      --bg: linear-gradient(135deg, #230b53, #1f1137);
      --text: #f5d5e0;
      --primary: #ff00ff;
      --card: rgba(45, 29, 82, 0.7);
      --border: rgba(255, 0, 255, 0.4);
      --shadow: rgba(255, 0, 255, 0.2);
      --success: #00ff9c;
      --danger: #ff3366;
      --muted-text: #a49fc4;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="nordic_aurora"] {
      --bg: #2E3440;
      --text: #ECEFF4;
      --primary: #88C0D0;
      --card: #3B4252;
      --border: #4C566A;
      --shadow: rgba(0, 0, 0, 0.2);
      --success: #A3BE8C;
      --danger: #BF616D;
      --muted-text: #D8DEE9;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="matcha_latte"] {
      --bg: #F3F9E9;
      --text: #4A5741;
      --primary: #82A36C;
      --card: #ffffff;
      --border: #D8E4CB;
      --shadow: rgba(74, 87, 65, 0.08);
      --success: #82A36C;
      --danger: #C7756D;
      --muted-text: #8C9C82;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="rose_quartz"] {
      --bg: #3B323B;
      --text: #FBE8F0;
      --primary: #E88DAF;
      --card: #524552;
      --border: #746374;
      --shadow: rgba(0, 0, 0, 0.15);
      --success: #7FD1B9;
      --danger: #D75D79;
      --muted-text: #D1C4D1;
      --notif-bar-bg: var(--primary);
    }
    [data-theme="aqua_gradient"] {
      --bg: linear-gradient(135deg, #6dd5ed, #2193b0);
      --text: #ffffff;
      --primary: #ffffff;
      --card: rgba(255, 255, 255, 0.2);
      --border: rgba(255, 255, 255, 0.4);
      --shadow: rgba(0, 0, 0, 0.15);
      --success: #81e979;
      --danger: #ff6b6b;
      --muted-text: #e0f7fa;
      --notif-bar-bg: linear-gradient(135deg, #8E2DE2, #4A00E0);
    }
    
    [data-theme="sunset"] .section-container, [data-theme="sunset"] header,
    [data-theme="synthwave"] .section-container, [data-theme="synthwave"] header,
    [data-theme="aqua_gradient"] header, [data-theme="aqua_gradient"] .section-container, [data-theme="aqua_gradient"] .info {
      backdrop-filter: blur(10px);
      border: 1px solid var(--border);
    }
    [data-theme="aqua_gradient"] h2, [data-theme="sunset"] h2 {
        text-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    [data-theme="aqua_gradient"] button, .btn-action {
        background: linear-gradient(135deg, #8E2DE2, #4A00E0);
        color: white !important;
        border: none;
        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    /* General Styling */
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--bg);
      color: var(--text);
      transition: background 0.3s ease, color 0.3s ease;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
      line-height: 1.6;
    }
    header {
      background: var(--card);
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid var(--border);
      z-index: 999;
      transition: all 0.3s ease;
    }
    header h1 { margin: 0; font-size: 24px; color: var(--primary); }
    main {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .auth-container {
      background: var(--card);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 15px var(--shadow);
      max-width: 450px;
      width: 100%;
      text-align: center;
    }
    label { font-weight: 600; margin-top: 15px; display: block; text-align: left; }
    input {
      width: 100%; padding: 12px; margin-top: 8px; margin-bottom: 15px;
      border-radius: 8px; border: 1px solid var(--border); background-color: var(--bg); color: var(--text);
    }
    .password-wrapper {
        position: relative;
        width: 100%;
    }
    .password-wrapper input {
        padding-right: 40px; /* Ruang untuk ikon */
    }
    .toggle-password {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        cursor: pointer;
        color: var(--muted-text);
        font-size: 0.9em;
    }
    button {
      width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px;
      border: none; background: var(--primary); color: white; cursor: pointer;
      font-weight: bold; font-size: 16px; transition: all 0.2s ease;
    }
    button:disabled { background-color: #bdc3c7; cursor: not-allowed; }
    .switch-auth-mode {
      margin-top: 20px;
      font-size: 0.9em;
      color: var(--muted-text);
    }
    .switch-auth-mode a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      transition: color 0.2s ease;
    }
    .switch-auth-mode a:hover {
      color: var(--text);
    }
    .notification {
        padding: 10px;
        margin-bottom: 15px;
        border-radius: 8px;
        font-weight: 600;
        display: none;
        text-align: center;
        border: 1px solid transparent;
    }
    .notification.success {
        background-color: #d4edda;
        color: #155724;
        border-color: #c3e6cb;
    }
    .notification.error {
        background-color: #f8d7da;
        color: #721c24;
        border-color: #f5c6cb;
    }
  </style>
</head>
<body>
<header>
    <div class="header-left">
        <a href="index.html" style="text-decoration: none;">
            <h1>Asdar Store Digital</h1>
        </a>
    </div>
    <div class="header-right">
        <!-- Tidak perlu tombol Akun Saya di sini karena ini adalah halaman akun -->
    </div>
</header>
  
<main>
    <div class="auth-container" data-aos="zoom-in">
        <div id="auth-notification" class="notification"></div>

        <!-- Login Form -->
        <form id="loginForm" class="active-form">
            <h2>Login Akun</h2>
            <label for="loginEmail">Email</label>
            <input type="email" id="loginEmail" placeholder="Masukkan email Anda" required />
            
            <label for="loginPassword">Password</label>
            <div class="password-wrapper">
                <input type="password" id="loginPassword" placeholder="Masukkan password Anda" required />
                <span class="toggle-password" onclick="togglePasswordVisibility('loginPassword')"><i class="fas fa-eye"></i></span>
            </div>
            
            <button type="submit" id="loginButton">Login</button>
            <div class="switch-auth-mode">
                Belum punya akun? <a href="#" id="showRegister">Daftar Sekarang</a>
            </div>
            <!-- Anda bisa menambahkan link "Lupa Password" di sini jika diinginkan -->
            <!-- <div class="switch-auth-mode mt-2"><a href="#">Lupa Password?</a></div> -->
        </form>

        <!-- Register Form -->
        <form id="registerForm" style="display: none;">
            <h2>Daftar Akun Baru</h2>
            <label for="registerName">Nama Lengkap</label>
            <input type="text" id="registerName" placeholder="Masukkan nama lengkap Anda" required />

            <label for="registerEmail">Email</label>
            <input type="email" id="registerEmail" placeholder="Masukkan email Anda" required />
            
            <label for="registerPassword">Password</label>
            <div class="password-wrapper">
                <input type="password" id="registerPassword" placeholder="Buat password (min. 6 karakter)" required />
                <span class="toggle-password" onclick="togglePasswordVisibility('registerPassword')"><i class="fas fa-eye"></i></span>
            </div>
            
            <button type="submit" id="registerButton">Daftar</button>
            <div class="switch-auth-mode">
                Sudah punya akun? <a href="#" id="showLogin">Login Sekarang</a>
            </div>
        </form>
    </div>
</main>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script> <!-- Mungkin tidak digunakan di halaman ini, tapi bisa tetap disertakan -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script> <!-- Mungkin tidak digunakan di halaman ini -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
    AOS.init({ duration: 800, once: true, offset: 50 });

    // === KONFIGURASI FIREBASE (HARUS SAMA DENGAN INDEX.HTML) ===
    const firebaseConfig = {
      apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210", // GANTI DENGAN API KEY FIREBASE ASLI ANDA
      authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com", // GANTI DENGAN DOMAIN FIREBASE ASLI ANDA
      databaseURL: "https://asdarstoredigitalll-d89c4-default-rtdb.firebaseio.com", // GANTI DENGAN REALTIME DB URL ASLI ANDA
      projectId: "asdarstoredigitalll-d89c4", // GANTI DENGAN PROJECT ID FIREBASE ASLI ANDA
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // DOM Elements
    const loginForm = document.getElementById('loginForm');
    const registerForm = document.getElementById('registerForm');
    const authNotification = document.getElementById('auth-notification');

    const loginEmailInput = document.getElementById('loginEmail');
    const loginPasswordInput = document.getElementById('loginPassword');
    const loginButton = document.getElementById('loginButton');

    const registerNameInput = document.getElementById('registerName');
    const registerEmailInput = document.getElementById('registerEmail');
    const registerPasswordInput = document.getElementById('registerPassword');
    const registerButton = document.getElementById('registerButton');

    // --- Fungsi Bantuan ---
    function showNotification(message, type = 'error') {
        authNotification.textContent = message;
        authNotification.className = `notification ${type}`;
        authNotification.style.display = 'block';
    }

    function hideNotification() {
        authNotification.style.display = 'none';
    }

    function disableFormButtons(formId, disabled) {
        const button = document.getElementById(formId === 'login' ? 'loginButton' : 'registerButton');
        if (button) {
            button.disabled = disabled;
            button.innerHTML = disabled ? '<i class="fas fa-spinner fa-spin"></i> Memproses...' : (formId === 'login' ? 'Login' : 'Daftar');
        }
    }

    function togglePasswordVisibility(inputId) {
        const passwordInput = document.getElementById(inputId);
        const icon = passwordInput.nextElementSibling.querySelector('i');
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            passwordInput.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }
    window.togglePasswordVisibility = togglePasswordVisibility; // Agar bisa diakses dari HTML

    // --- Fungsi Utama Auth ---

    // Fungsi Login
    loginForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        hideNotification();
        disableFormButtons('login', true);

        const email = loginEmailInput.value;
        const password = loginPasswordInput.value;

        try {
            await auth.signInWithEmailAndPassword(email, password);
            showNotification('Login berhasil! Mengarahkan...', 'success');
            setTimeout(() => {
                window.location.href = 'index.html'; // Redirect ke halaman utama
            }, 1500);
        } catch (error) {
            let errorMessage = "Terjadi kesalahan saat login.";
            switch (error.code) {
                case 'auth/user-not-found':
                    errorMessage = "Email tidak terdaftar. Silakan daftar atau periksa kembali email Anda.";
                    break;
                case 'auth/wrong-password':
                    errorMessage = "Password salah. Silakan coba lagi.";
                    break;
                case 'auth/invalid-email':
                    errorMessage = "Format email tidak valid.";
                    break;
                case 'auth/too-many-requests':
                    errorMessage = "Terlalu banyak percobaan login gagal. Coba lagi nanti.";
                    break;
                default:
                    errorMessage = `Error: ${error.message}`;
            }
            showNotification(errorMessage, 'error');
            disableFormButtons('login', false);
            console.error("Login Error:", error);
        }
    });

    // Fungsi Registrasi
    registerForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        hideNotification();
        disableFormButtons('register', true);

        const name = registerNameInput.value;
        const email = registerEmailInput.value;
        const password = registerPasswordInput.value;

        if (password.length < 6) {
            showNotification("Password minimal 6 karakter.", "error");
            disableFormButtons('register', false);
            return;
        }

        try {
            const userCredential = await auth.createUserWithEmailAndPassword(email, password);
            await userCredential.user.updateProfile({
                displayName: name
            });
            
            // Opsional: Simpan data tambahan user di Firestore
            await firebase.firestore().collection('users').doc(userCredential.user.uid).set({
                nama: name,
                email: email,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });

            showNotification('Pendaftaran berhasil! Mengarahkan...', 'success');
            setTimeout(() => {
                window.location.href = 'index.html'; // Redirect ke halaman utama
            }, 1500);

        } catch (error) {
            let errorMessage = "Terjadi kesalahan saat pendaftaran.";
            switch (error.code) {
                case 'auth/email-already-in-use':
                    errorMessage = "Email ini sudah terdaftar. Silakan login atau gunakan email lain.";
                    break;
                case 'auth/weak-password':
                    errorMessage = "Password terlalu lemah. Mohon gunakan password yang lebih kuat.";
                    break;
                case 'auth/invalid-email':
                    errorMessage = "Format email tidak valid.";
                    break;
                default:
                    errorMessage = `Error: ${error.message}`;
            }
            showNotification(errorMessage, 'error');
            disableFormButtons('register', false);
            console.error("Register Error:", error);
        }
    });

    // --- Toggler Form ---
    document.getElementById('showRegister').addEventListener('click', (e) => {
        e.preventDefault();
        loginForm.style.display = 'none';
        registerForm.style.display = 'block';
        hideNotification(); // Sembunyikan notifikasi saat ganti form
        // Reset input form yang disembunyikan
        loginEmailInput.value = '';
        loginPasswordInput.value = '';
    });

    document.getElementById('showLogin').addEventListener('click', (e) => {
        e.preventDefault();
        registerForm.style.display = 'none';
        loginForm.style.display = 'block';
        hideNotification(); // Sembunyikan notifikasi saat ganti form
        // Reset input form yang disembunyikan
        registerNameInput.value = '';
        registerEmailInput.value = '';
        registerPasswordInput.value = '';
    });

    // === LOGIKA TEMA (SAMA DENGAN INDEX.HTML) ===
    document.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('selectedTheme') || 'aqua_gradient';
      if (savedTheme === 'light') { document.body.removeAttribute('data-theme'); }
      else { document.body.setAttribute('data-theme', savedTheme); }
    });
</script>
</body>
</html>
