<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Admin - Asdar Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <style>
    body { padding: 20px; background-color: #f5f5f5; font-family: 'Poppins', sans-serif; }
    h1 { margin-bottom: 20px; }
    .card { margin-bottom: 15px; }
    img { max-width: 100px; margin-top: 10px; border-radius: 5px; }
    #galeri img { max-width: 120px; margin: 5px; border-radius: 6px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Dashboard Admin - Asdar Store</h1>

    <!-- Fitur Tambahan Hapus Semua -->
    <div class="mb-3 d-flex flex-wrap gap-2">
      <button class="btn btn-danger" onclick="hapusSemuaPesanan()">ğŸ—‘ï¸ Hapus Semua Pesanan</button>
      <button class="btn btn-danger" onclick="hapusSemuaProduk()">ğŸ—‘ï¸ Hapus Semua Produk</button>
      <button class="btn btn-danger" onclick="hapusSemuaGaleri()">ğŸ—‘ï¸ Hapus Semua Bukti Transfer</button>
      <button class="btn btn-dark" onclick="hapusSemuaData()">ğŸ”¥ Hapus Semua Data</button>
    </div>

    <!-- Filter & Pencarian -->
    <div class="row mb-3">
      <div class="col-md-4">
        <select id="filterStatus" class="form-select">
          <option value="">Filter Semua Status</option>
          <option value="Belum Bayar">Belum Bayar</option>
          <option value="Sudah Bayar">Sudah Bayar</option>
          <option value="Diproses">Diproses</option>
          <option value="Selesai">Selesai</option>
        </select>
      </div>
      <div class="col-md-4">
        <input type="text" id="searchId" class="form-control" placeholder="Cari ID Pesanan" />
      </div>
      <div class="col-md-4">
        <button class="btn btn-success w-100" id="exportCSVBtn">Export CSV</button>
      </div>
    </div>

    <!-- Daftar Pesanan -->
    <div id="pesananList"></div>

    <!-- Upload Bukti Admin -->
    <h3>Upload Bukti Admin ke Pembeli</h3>
    <input type="file" id="buktiAdmin" class="form-control mb-2" accept="image/*" />
    <button id="uploadBuktiBtn" class="btn btn-primary mb-4">Kirim Bukti & Selesaikan</button>

    <hr>

    <!-- Form Produk -->
    <h3>Tambah / Edit Produk</h3>
    <form id="formProduk" class="row g-3 mb-4">
      <div class="col-md-3">
        <input type="text" id="kategori" class="form-control" placeholder="Kategori Produk" required />
      </div>
      <div class="col-md-3">
        <input type="text" id="varian" class="form-control" placeholder="Varian / Nama Produk" required />
      </div>
      <div class="col-md-2">
        <input type="number" id="harga" class="form-control" placeholder="Harga (Rp)" required />
      </div>
      <div class="col-md-4">
        <input type="text" id="cara" class="form-control" placeholder="Keterangan / Cara Beli" required />
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-success">Simpan / Edit Produk</button>
      </div>
    </form>

    <!-- Daftar Produk -->
    <h4>Daftar Produk</h4>
    <ul id="daftarProduk" class="list-group mb-5"></ul>

    <!-- Galeri Bukti Bayar -->
    <h4>Galeri Bukti Transfer</h4>
    <div id="galeri" class="d-flex flex-wrap"></div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
      authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
      databaseURL: "https://asdarstoredigitalll-d89c4-default-rtdb.firebaseio.com",
      projectId: "asdarstoredigitalll-d89c4",
      storageBucket: "asdarstoredigitalll.appspot.com",
      messagingSenderId: "220670500351",
      appId: "1:220670500351:web:5737ae5958a6f5a67d5bca"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // FUNGSI HAPUS SEMUA
    function hapusSemuaPesanan() {
      if (confirm("Yakin ingin menghapus SEMUA PESANAN?")) {
        db.ref("pesanan").remove().then(() => {
          alert("âœ… Semua pesanan berhasil dihapus.");
          tampilkanPesanan();
        });
      }
    }

    function hapusSemuaProduk() {
      if (confirm("Yakin ingin menghapus SEMUA PRODUK?")) {
        db.ref("produk").remove().then(() => {
          alert("âœ… Semua produk berhasil dihapus.");
          tampilkanProduk();
        });
      }
    }

    function hapusSemuaGaleri() {
      if (confirm("Yakin ingin menghapus SEMUA BUKTI BAYAR?")) {
        db.ref("pesanan").once("value").then(snapshot => {
          const data = snapshot.val() || {};
          for (const id in data) {
            db.ref(`pesanan/${id}/buktiBayar`).remove();
          }
          alert("âœ… Semua bukti bayar berhasil dihapus.");
          tampilkanGaleri();
          tampilkanPesanan();
        });
      }
    }

    function hapusSemuaData() {
      if (confirm("ğŸ”¥ Hapus SEMUA DATA (pesanan, produk, bukti)?")) {
        db.ref().set({}).then(() => {
          alert("ğŸ”¥ Semua data berhasil direset.");
          tampilkanGaleri();
          tampilkanPesanan();
          tampilkanProduk();
        });
      }
    }

    // ...lanjutan fungsi tampilkanPesanan(), tampilkanProduk(), tampilkanGaleri(), uploadBukti(), dll
    // Sudah Anda punya sebelumnya â€” tidak perlu diubah, tetap lanjutkan semua seperti biasa
  </script>
</body>
</html>
