<!-- FINAL admin.html - Admin Dinamis Asdar Store --><!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Admin Dinamis - Asdar Store</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <style>
    body { padding: 20px; background: #f5f5f5; font-family: 'Poppins', sans-serif; }
    h1 { margin-bottom: 20px; }
    textarea { min-height: 120px; }
  </style>
</head>
<body>
<div class="container">
  <h1>Dashboard Admin Dinamis</h1>  <!-- 🔧 Pengaturan Dinamis Halaman -->  <h4>🔧 Pengaturan Toko</h4>
  <form id="formPengaturan">
    <div class="mb-3">
      <label>Judul Halaman:</label>
      <input type="text" class="form-control" id="judulHalaman" required />
    </div>
    <div class="mb-3">
      <label>Pengumuman di Toko:</label>
      <textarea class="form-control" id="pengumuman"></textarea>
    </div>
    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="fiturTestimoni">
      <label class="form-check-label">Aktifkan Testimoni</label>
    </div>
    <div class="form-check form-switch mb-3">
      <input class="form-check-input" type="checkbox" id="fiturUpload">
      <label class="form-check-label">Wajib Upload Bukti Bayar</label>
    </div>
    <button type="submit" class="btn btn-primary">💾 Simpan Pengaturan</button>
  </form>  <hr/>  <!-- 🔧 Builder Field Tambahan -->  <h4>➕ Buat Form Tambahan</h4>
  <form id="formField">
    <div class="mb-3">
      <label>Nama Field Baru (misal: Catatan, Alamat):</label>
      <input type="text" class="form-control" id="namaField" required />
    </div>
    <div class="mb-3">
      <label>Placeholder / Petunjuk:</label>
      <input type="text" class="form-control" id="placeholderField" />
    </div>
    <button type="submit" class="btn btn-success">➕ Tambah Field</button>
  </form>  <ul id="listField" class="list-group mt-3"></ul>
</div><!-- Firebase SDK --><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script><script>
  const firebaseConfig = {
    apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
    authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
    databaseURL: "https://asdarstoredigitalll-default-rtdb.firebaseio.com",
    projectId: "asdarstoredigitalll-d89c4",
    storageBucket: "asdarstoredigitalll.appspot.com",
    messagingSenderId: "220670500351",
    appId: "1:220670500351:web:5737ae5958a6f5a67d5bca"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const formPengaturan = document.getElementById('formPengaturan');
  const formField = document.getElementById('formField');
  const listField = document.getElementById('listField');

  function loadPengaturan() {
    db.ref('pengaturan').once('value').then(snap => {
      const p = snap.val() || {};
      document.getElementById('judulHalaman').value = p.judulHalaman || '';
      document.getElementById('pengumuman').value = p.pengumuman || '';
      document.getElementById('fiturTestimoni').checked = !!p.fiturTestimoni;
      document.getElementById('fiturUpload').checked = !!p.fiturUpload;
    });
  }

  function loadFieldTambahan() {
    db.ref('fieldTambahan').once('value').then(snap => {
      const data = snap.val() || {};
      listField.innerHTML = '';
      Object.keys(data).forEach(key => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between';
        li.innerHTML = `<div><b>${key}</b>: ${data[key]}</div>
        <button class="btn btn-sm btn-danger" onclick="hapusField('${key}')">🗑️ Hapus</button>`;
        listField.appendChild(li);
      });
    });
  }

  formPengaturan.onsubmit = e => {
    e.preventDefault();
    const data = {
      judulHalaman: document.getElementById('judulHalaman').value,
      pengumuman: document.getElementById('pengumuman').value,
      fiturTestimoni: document.getElementById('fiturTestimoni').checked,
      fiturUpload: document.getElementById('fiturUpload').checked,
    };
    db.ref('pengaturan').set(data).then(() => alert('✅ Pengaturan disimpan!'));
  };

  formField.onsubmit = e => {
    e.preventDefault();
    const key = document.getElementById('namaField').value.trim();
    const val = document.getElementById('placeholderField').value.trim();
    if (!key) return;
    db.ref('fieldTambahan/' + key).set(val).then(() => {
      alert('✅ Field ditambahkan!');
      formField.reset();
      loadFieldTambahan();
    });
  };

  function hapusField(key) {
    if (confirm(`Hapus field '${key}'?`)) {
      db.ref('fieldTambahan/' + key).remove().then(loadFieldTambahan);
    }
  }

  loadPengaturan();
  loadFieldTambahan();
</script></body>
</html>
