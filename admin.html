<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Admin - Asdar Store</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { padding: 20px; background-color: #f5f5f5; font-family: 'Poppins', sans-serif; }
    h1 { margin-bottom: 20px; }
    .card { margin-bottom: 15px; }
    img { max-width: 100px; margin-top: 10px; border-radius: 5px; }
    #galeri img { max-width: 120px; margin: 5px; border-radius: 6px; }
    textarea { font-family: monospace; }
  </style>
</head>
<body>
<div class="container">
  <h1>Dashboard Admin - Asdar Store</h1>
  <!-- Semua elemen dashboard seperti filter, upload bukti, form produk, galeri, dsb -->
  <div id="pesananList"></div>
  <div id="daftarProduk"></div>
  <div id="galeri"></div>  <!-- Editor Dinamis -->  <hr/>
  <h4>🧩 Editor Fitur Dinamis</h4>
  <form id="formFiturDinamis" class="mb-4">
    <input class="form-control mb-2" id="halamanFitur" placeholder="Contoh: index.html" required /><label>HTML</label>
<div id="editorHTML" style="height: 150px; width: 100%;" class="mb-2"></div>

<label>CSS</label>
<div id="editorCSS" style="height: 100px; width: 100%;" class="mb-2"></div>

<label>JS</label>
<div id="editorJS" style="height: 100px; width: 100%;" class="mb-2"></div>

<button type="submit" class="btn btn-success">💾 Simpan Fitur</button>
<button type="button" class="btn btn-danger" onclick="hapusFiturDinamis()">🗑️ Hapus</button>

  </form>  <h5>📺 Preview Langsung</h5>
  <div id="previewDinamis" class="border p-3 bg-light rounded"></div>
</div><!-- Firebase SDK --><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script><!-- Script utama dashboard admin --><script>
  // ... semua script dashboard admin termasuk tampilkanPesanan, uploadBukti, tampilkanProduk, dsb.
</script><!-- Ace Editor CDN --><script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script><!-- Script Editor Fitur Dinamis --><script>
const editorHTML = ace.edit("editorHTML", { mode: "ace/mode/html", theme: "ace/theme/github" });
const editorCSS = ace.edit("editorCSS", { mode: "ace/mode/css", theme: "ace/theme/github" });
const editorJS = ace.edit("editorJS", { mode: "ace/mode/javascript", theme: "ace/theme/github" });

const preview = document.getElementById("previewDinamis");
const form = document.getElementById("formFiturDinamis");

form.addEventListener("submit", function (e) {
  e.preventDefault();
  const halaman = document.getElementById("halamanFitur").value;
  const html = editorHTML.getValue();
  const css = editorCSS.getValue();
  const js = editorJS.getValue();

  db.ref("fiturDinamis/" + halaman).set({ html, css, js }).then(() => {
    alert("✅ Fitur berhasil disimpan.");
    tampilkanPreview(html, css, js);
  });
});

function tampilkanPreview(html, css, js) {
  preview.innerHTML = `<style>${css}</style>${html}<script>${js}<\/script>`;}

function hapusFiturDinamis() { const halaman = document.getElementById("halamanFitur").value; if (confirm("Yakin ingin hapus fitur ini?")) { db.ref("fiturDinamis/" + halaman).remove().then(() => { alert("✅ Fitur dihapus."); editorHTML.setValue(""); editorCSS.setValue(""); editorJS.setValue(""); preview.innerHTML = ""; }); } }

window.addEventListener("DOMContentLoaded", () => { const halaman = window.location.pathname.split("/").pop(); db.ref("fiturDinamis/" + halaman).once("value").then(snapshot => { const data = snapshot.val(); if (data) { if (document.getElementById("halamanFitur")) { document.getElementById("halamanFitur").value = halaman; editorHTML.setValue(data.html, -1); editorCSS.setValue(data.css, -1); editorJS.setValue(data.js, -1); tampilkanPreview(data.html, data.css, data.js); } else { const style = document.createElement("style"); style.innerHTML = data.css; document.head.appendChild(style);

const div = document.createElement("div");
    div.innerHTML = data.html;
    document.body.appendChild(div);

    const script = document.createElement("script");
    script.innerHTML = data.js;
    document.body.appendChild(script);
  }
}

}); }); </script>

</body>
</html>
