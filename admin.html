<!DOCTYPE html><html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard Admin Asdar Store Digital</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    body { font-family: 'Poppins', sans-serif; background: #f5f7ff; margin: 0; padding: 20px; }
    h1 { color: #007BFF; text-align: center; margin-bottom: 30px; }
    section { background: white; border-radius: 12px; padding: 20px; margin-bottom: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
    th, td { border: 1px solid #ddd; padding: 12px 8px; text-align: left; }
    th { background: #007BFF; color: white; }
    button { background-color: #007BFF; border: none; color: white; padding: 6px 12px; border-radius: 6px; cursor: pointer; margin-right: 6px; transition: background-color 0.3s ease; }
    button:hover { background-color: #0056b3; }
    .btn-danger { background-color: #dc3545; }
    .btn-danger:hover { background-color: #a71d2a; }
    img.bukti { max-width: 120px; border-radius: 8px; box-shadow: 0 0 8px rgba(0,0,0,0.1); }
  </style>
</head>
<body><h1>Dashboard Admin Asdar Store Digital</h1><section>
  <h2>ðŸ“¦ Manajemen Produk</h2>
  <form id="formProduk" onsubmit="tambahProduk(event)">
    <select id="kategoriProdukInput" required>
      <option value="">Pilih Kategori</option>
      <option value="kvision">K-Vision</option>
      <option value="nex">Nex Parabola</option>
      <option value="mnc">MNC Vision</option>
      <option value="xl">XL Data</option>
      <option value="pulsa">Pulsa</option>
    </select>
    <input type="text" id="namaProdukInput" placeholder="Nama Produk" required />
    <input type="number" id="hargaProdukInput" placeholder="Harga (contoh: 30000)" required />
    <button type="submit">Tambah Produk</button>
  </form>  <table id="tableProduk">
    <thead>
      <tr><th>ID</th><th>Kategori</th><th>Nama Produk</th><th>Harga</th><th>Aksi</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section><section>
  <h2>ðŸ“‘ Daftar Transaksi</h2>
  <table id="tableTransaksi">
    <thead>
      <tr><th>ID</th><th>Nomor HP</th><th>Produk</th><th>Harga (Rp)</th><th>Status</th><th>Bukti Bayar</th><th>Aksi</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section><section>
  <h2>ðŸ’¬ Testimoni Pelanggan</h2>
  <table id="tableTestimoni">
    <thead>
      <tr><th>ID</th><th>Nama</th><th>Isi Testimoni</th><th>Aksi</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section><script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script><script>
  const firebaseConfig = {
    apiKey: "AIzaSyA_L6U3HKM1DnKuq_Q1zKFH4bk8GMAz210",
    authDomain: "asdarstoredigitalll-d89c4.firebaseapp.com",
    databaseURL: "https://asdarstoredigitalll-d89c4-default-rtdb.firebaseio.com",
    projectId: "asdarstoredigitalll-d89c4",
    storageBucket: "asdarstoredigitalll-d89c4.appspot.com",
    messagingSenderId: "220670500351",
    appId: "1:220670500351:web:5737ae5958a6f5a67d5bca"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function tampilkanProduk() {
    const tbody = document.querySelector("#tableProduk tbody");
    db.ref("produk").on("value", snapshot => {
      tbody.innerHTML = "";
      const data = snapshot.val();
      if (!data) return tbody.innerHTML = "<tr><td colspan='5'>Belum ada produk.</td></tr>";
      Object.entries(data).forEach(([key, val]) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${key}</td>
          <td>${val.kategori}</td>
          <td><input value="${val.nama}" onchange="updateProduk('${key}', { nama: this.value })" /></td>
          <td><input type="number" value="${val.harga}" onchange="updateProduk('${key}', { harga: parseInt(this.value) })" /></td>
          <td><button class="btn-danger" onclick="hapusProduk('${key}')">Hapus</button></td>`;
        tbody.appendChild(tr);
      });
    });
  }

  function tambahProduk(e) {
    e.preventDefault();
    const kategori = document.getElementById("kategoriProdukInput").value;
    const nama = document.getElementById("namaProdukInput").value.trim();
    const harga = parseInt(document.getElementById("hargaProdukInput").value);
    if (!kategori || !nama || !harga) return alert("Isi semua data.");
    db.ref("produk").push({ kategori, nama, harga })
      .then(() => document.getElementById("formProduk").reset());
  }

  function updateProduk(id, data) {
    db.ref("produk/" + id).update(data);
  }

  function hapusProduk(id) {
    if (confirm("Yakin hapus produk?")) db.ref("produk/" + id).remove();
  }

  function tampilkanTransaksi() {
    const tbody = document.querySelector("#tableTransaksi tbody");
    db.ref("transaksi").on("value", snapshot => {
      tbody.innerHTML = "";
      const data = snapshot.val();
      if (!data) return tbody.innerHTML = "<tr><td colspan='7'>Belum ada transaksi.</td></tr>";
      Object.entries(data).forEach(([key, val]) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${key}</td>
          <td>${val.nama || '-'}</td>
          <td>${val.produkNama || '-'}</td>
          <td>${val.harga?.toLocaleString() || '-'}</td>
          <td>${val.status || '-'}</td>
          <td>${val.buktiBayarUrl ? `<img src="${val.buktiBayarUrl}" class="bukti" />` : '-'}</td>
          <td>
            ${val.status === "Pending" ? `<button onclick="updateStatus('${key}', 'Lunas')">Set Lunas</button>` : ''}
            <button class="btn-danger" onclick="hapusTransaksi('${key}')">Hapus</button>
          </td>`;
        tbody.appendChild(tr);
      });
    });
  }

  function updateStatus(id, statusBaru) {
    if (confirm(`Ubah status menjadi ${statusBaru}?`)) {
      db.ref("transaksi/" + id).update({ status: statusBaru });
    }
  }

  function hapusTransaksi(id) {
    if (confirm("Yakin ingin menghapus?")) {
      db.ref("transaksi/" + id).remove();
    }
  }

  function tampilkanTestimoni() {
    const tbody = document.querySelector("#tableTestimoni tbody");
    db.ref("testimoni").on("value", snapshot => {
      tbody.innerHTML = "";
      const data = snapshot.val();
      if (!data) return tbody.innerHTML = "<tr><td colspan='4'>Belum ada testimoni.</td></tr>";
      Object.entries(data).forEach(([key, val]) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${key}</td>
          <td>${val.nama}</td>
          <td>${val.isi}</td>
          <td><button class="btn-danger" onclick="hapusTestimoni('${key}')">Hapus</button></td>`;
        tbody.appendChild(tr);
      });
    });
  }

  function hapusTestimoni(id) {
    if (confirm("Hapus testimoni?")) {
      db.ref("testimoni/" + id).remove();
    }
  }

  window.onload = () => {
    tampilkanProduk();
    tampilkanTransaksi();
    tampilkanTestimoni();
  };
</script></body>
</html>
